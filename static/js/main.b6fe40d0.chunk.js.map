{"version":3,"sources":["functions.js","App.js","index.js"],"names":["getRequestError","error","response","data","code","status","errors","message","App","props","_formData$message5","_convoMessages$curren5","_formData$message6","_formData$message7","_formData$message8","_formData$message8$at","widget_id","widgetid","_useState","useState","_useState2","_slicedToArray","showWidget","setShowWidget","_useState3","_useState4","isWidgetOpen","setIsWidgetOpen","_useState5","_useState6","isWidgetTooltipOpen","setIsWidgetTooltipOpen","_useState7","_useState8","isLiveChatOpen","setIsLiveChatOpen","_useState9","_useState10","isSignUpFormOpen","setIsSignUpFormOpen","_useState11","_useState12","convoData","setConvoData","_useState13","_useState14","widgetConfig","setWidgetConfig","_useState15","_useState16","formData","setFormData","_useState17","_useState18","isUploading","setIsUploading","_useState19","_useState20","isLoadingMessages","setIsLoadingMessages","_useState21","_useState22","isLoadingPrevMessages","setIsLoadingPrevMessages","_useState23","_useState24","isSubmitting","setIsSubmitting","_useState25","_useState26","scrolltoBottom","triggerScrollToBottom","_useState27","_useState28","errorMsg","setErrorMsg","_ref","color","logo","headText","subText","toolTip","channels","baseURL","liveChatCredentials","find","x","_x$name","name","toLowerCase","conversationIdRef","useRef","localStorage","getItem","isLastPageOfMessages","convoMessages","chatContentRef","getWidgetConfigs","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","errorMessage","wrap","_context","prev","next","fetch","concat","sent","json","success","t0","stop","apply","arguments","useEffect","_window$location$href","window","location","href","includes","current","getConversation","socket","io","reconnectionDelay","reconnection","transports","element","document","querySelector","on","_data$conversation","_data$message","_data$message$sender","conversation","id","sender","authUser","setAttribute","widgetElement","timer","setInterval","getAttribute","getConvoMessages","clearInterval","_document","chatMessagesEl","addEventListener","loadMoreChats","getChannelIcon","channel","determineColorFromBg","_color","_color3","_color5","_color6","_color7","_color2","_color4","_color4$split","_color4$split$map","slice","length","split","map","hex","join","parseInt","substr","handleChange","e","_e$target","_e$target2","_objectSpread","_defineProperty","target","value","handleMessageChange","_e$target3","text","ScrollToBottom","elementRef","scrollIntoView","behavior","React","createElement","ref","_ref3","_callee2","_res$data","_res$data$customer","_res$data2","_res$data2$customer","_context2","email","customer","_ref4","_callee3","load","noPaginate","_convoMessages$curren","_convoMessages$curren2","lastRowId","_res$data3","_res$data4","_res$data5","_context3","row_id","_toConsumableArray","reverse","_x","_x2","_chatContentRef$curre","_convoMessages$curren3","scrollTop","then","chatContainer","scrollHeight","scrollToMiddle","startConversation","_ref5","_callee4","_formData$message","_formData$message$tex","_res$data6","_res$data7","_context4","preventDefault","to","method","body","JSON","stringify","headers","conversation_id","setItem","_x3","handleUploadFile","_ref6","_callee5","_e$target4","files","fileToUpload","fileData","_context5","FormData","append","attachment","url","type","_x4","replyConversation","_ref7","_callee6","_formData$message2","_formData$message2$te","_formData$message3","_formData$message3$at","_formData$message4","_convoMessages$curren4","filteredMessage","_context6","imageUrl","content","updatedAt","Date","filter","Fragment","className","style","backgroundColor","onClick","src","alt","agent","identifier","placeholder","onChange","disabled","msg","i","_msg$sender","_msg$sender2","key","date","d","hr","getHours","min","getMinutes","ampm","formatTime","rows","getElementById","click","hidden","rel","_ref8","root","ReactDOM","render","dataset"],"mappings":"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","file":"static/js/main.b6fe40d0.chunk.js","sourcesContent":["export const getRequestError = (error) => {\n  const { response } = error;\n  if (response && (response.data.code === 401 || response.status === 401)) {\n    return \"\";\n  } else if (response && response.data.errors && response.data.errors[0]) {\n    return response.data.errors[0].message;\n  } else if (response && response.data.message) {\n    return response.data.message;\n  } else if (response && response.data.error) {\n    return response.data.error;\n  }\n  return \"There might be a problem with your internet connection. Please check and try again.\";\n};\n\nexport const formatTime = (date) => {\n  var d = new Date(date);\n  var hr = d.getHours();\n  var min = d.getMinutes();\n  if (min < 10) {\n    min = \"0\" + min;\n  }\n  var ampm = \" AM\";\n  if (hr > 12) {\n    hr -= 12;\n    ampm = \" PM\";\n  }\n  return hr + \":\" + min + ampm || \"\";\n};\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { io } from \"socket.io-client\";\n\nimport { formatTime, getRequestError } from \"./functions\";\n\nimport \"regenerator-runtime/runtime\";\n\nimport \"./App.css\";\n\nfunction App(props) {\n  var widget_id = props?.widgetid;\n\n  const [showWidget, setShowWidget] = useState(false);\n  const [isWidgetOpen, setIsWidgetOpen] = useState(false);\n  const [isWidgetTooltipOpen, setIsWidgetTooltipOpen] = useState(true);\n  const [isLiveChatOpen, setIsLiveChatOpen] = useState(false);\n  const [isSignUpFormOpen, setIsSignUpFormOpen] = useState(true);\n  const [convoData, setConvoData] = useState({});\n  const [widgetConfig, setWidgetConfig] = useState({});\n  const [formData, setFormData] = useState({});\n  const [isUploading, setIsUploading] = useState(false);\n  const [isLoadingMessages, setIsLoadingMessages] = useState(false);\n  const [isLoadingPrevMessages, setIsLoadingPrevMessages] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(null);\n  const [scrolltoBottom, triggerScrollToBottom] = useState(false);\n  const [errorMsg, setErrorMsg] = useState(null);\n\n  var { color, logo, headText, subText, toolTip, channels } =\n    widgetConfig || {};\n\n  // const baseURL = \"https://api.oneroute.io/\";\n  const baseURL = \"https://api.staging.oneroute.io/\";\n\n  const PAGE_SIZE = 10;\n\n  const liveChatCredentials = channels?.find(\n    (x) => x?.name?.toLowerCase() === \"livechat\"\n  );\n\n  const conversationIdRef = useRef(\n    localStorage.getItem(\"conversationId\") || null\n  );\n\n  const isLastPageOfMessages = useRef(false);\n\n  const convoMessages = useRef([]);\n\n  const chatContentRef = useRef();\n\n  const getWidgetConfigs = async () => {\n    try {\n      let response = await fetch(`${baseURL}api/widget/${widget_id}`);\n      const res = await response.json();\n\n      const success = res?.success;\n      if (success === true) {\n        setWidgetConfig(res?.data);\n      }\n    } catch (err) {\n      const errorMessage = getRequestError(err);\n      setErrorMsg(errorMessage);\n    }\n  };\n  useEffect(() => {\n    getWidgetConfigs();\n\n    if (!window.location.href?.includes(\"/feedback\")) {\n      setShowWidget(true);\n    }\n\n    if (conversationIdRef.current) {\n      setIsSignUpFormOpen(false);\n      getConversation();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // WebSocket.io Script Starts Here\n  useEffect(() => {\n    var socket = io(baseURL, {\n      reconnectionDelay: 1000,\n      reconnection: true,\n      transports: [\"websocket\"],\n    });\n\n    var element = document.querySelector(\".oneroute_widget\");\n\n    socket.on(\"newMessage\", (data) => {\n      if (\n        data?.conversation?.id === localStorage.getItem(\"conversationId\") &&\n        data?.message?.sender?.authUser !== false\n      ) {\n        element.setAttribute(\"data-newmessage\", \"true\");\n      }\n    });\n  }, []);\n  // WebSocket.io Script Ends Here\n\n  var widgetElement = document.querySelector(\".oneroute_widget\");\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      var widgetValue = widgetElement.getAttribute(\"data-newmessage\");\n      if (widgetValue === \"true\") {\n        getConvoMessages(false, true);\n      }\n    }, 1000);\n\n    // clearing interval\n    return () => clearInterval(timer);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (!isWidgetOpen) {\n      setIsWidgetTooltipOpen(true);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isWidgetOpen]);\n\n  useEffect(() => {\n    const chatMessagesEl = document?.querySelector(\".chat_messages\");\n\n    if (isLiveChatOpen && chatMessagesEl) {\n      chatMessagesEl.addEventListener(\"scroll\", loadMoreChats);\n\n      triggerScrollToBottom(true);\n      const timer = setInterval(() => {\n        triggerScrollToBottom(false);\n        clearInterval(timer);\n      }, 1000);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isLiveChatOpen]);\n\n  const getChannelIcon = (channel) => {\n    switch (channel.toLowerCase()) {\n      case \"livechat\":\n        return \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/oneroute.svg\";\n      case \"email\":\n        return \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/email.svg\";\n      case \"instagram\":\n        return \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/instagram.svg\";\n      case \"facebook\":\n        return \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/facebook.svg\";\n      case \"oneroute\":\n        return \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/oneroute.svg\";\n      case \"sms\":\n        return \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/sms.svg\";\n      case \"twitter\":\n        return \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/twitter.svg\";\n      case \"whatsapp\":\n        return \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/whatsapp.svg\";\n      default:\n        return;\n    }\n  };\n\n  const determineColorFromBg = () => {\n    // If a leading # is provided, remove it\n    if (color?.slice(0, 1) === \"#\") {\n      color = color?.slice(1);\n    }\n\n    // If a three-character hexcode, make six-character\n    if (color?.length === 3) {\n      color = color\n        ?.split(\"\")\n        ?.map(function (hex) {\n          return hex + hex;\n        })\n        ?.join(\"\");\n    }\n\n    // Convert to RGB value\n    var r = parseInt(color?.substr(0, 2), 16);\n    var g = parseInt(color?.substr(2, 2), 16);\n    var b = parseInt(color?.substr(4, 2), 16);\n\n    // Get YIQ ratio\n    var yiq = (r * 299 + g * 587 + b * 114) / 1000;\n\n    // Check contrast\n    return yiq >= 128 ? \"#000000\" : \"#FFFFFF\";\n  };\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e?.target?.name]: e?.target?.value,\n    });\n\n    if (errorMsg) setErrorMsg(null);\n  };\n\n  const handleMessageChange = (e) => {\n    setFormData({\n      ...formData,\n      message: {\n        ...formData?.message,\n        text: e?.target?.value,\n      },\n    });\n\n    if (errorMsg) setErrorMsg(null);\n  };\n\n  const ScrollToBottom = () => {\n    const elementRef = useRef();\n    useEffect(() => elementRef.current.scrollIntoView({ behavior: \"smooth\" }));\n    return <div ref={elementRef} />;\n  };\n\n  const scrollToMiddle = () => {\n    const chatContainer = chatContentRef.current;\n    if (chatContainer) {\n      chatContainer.scrollTop = chatContainer.scrollHeight / 4;\n    }\n  };\n\n  const getConversation = async () => {\n    try {\n      let response = await fetch(\n        `${baseURL}api/conversations/${conversationIdRef.current}`\n      );\n      const res = await response.json();\n\n      const success = res?.success;\n      if (success === true) {\n        setConvoData(res?.data);\n        setFormData({\n          email: res?.data?.customer?.email,\n          name: res?.data?.customer?.name,\n        });\n\n        getConvoMessages(true, true);\n      }\n    } catch (err) {\n      setIsSignUpFormOpen(true);\n      const errorMessage = getRequestError(err);\n      setErrorMsg(errorMessage);\n    }\n  };\n\n  const getConvoMessages = async (load, noPaginate) => {\n    widgetElement.setAttribute(\"data-newmessage\", \"false\");\n    load && setIsLoadingMessages(true);\n\n    const lastRowId = convoMessages.current?.[0]?.row_id;\n\n    if (!isLastPageOfMessages.current) {\n      try {\n        let response = await fetch(\n          `${baseURL}api/conversations/${\n            conversationIdRef.current\n          }/messages?page[size]=${PAGE_SIZE}${\n            noPaginate ? `` : `&lastMessageAt=${lastRowId}`\n          }`\n        );\n        const res = await response.json();\n\n        const success = res?.success;\n        if (success === true) {\n          convoMessages.current = noPaginate\n            ? [...res?.data?.reverse()]\n            : [...res?.data?.reverse(), ...(convoMessages.current || [])];\n          isLastPageOfMessages.current = res?.data?.length < 10 ? true : false;\n\n          load && setIsLoadingMessages(false);\n          load && setIsSubmitting(null);\n        } else {\n          load && setIsLoadingMessages(false);\n        }\n      } catch (err) {\n        load && setIsLoadingMessages(false);\n        setIsSignUpFormOpen(true);\n        const errorMessage = getRequestError(err);\n        setErrorMsg(errorMessage);\n      }\n    }\n  };\n\n  const loadMoreChats = () => {\n    const scrollTop = chatContentRef.current?.scrollTop;\n\n    if (\n      scrollTop <= 0 &&\n      !isLastPageOfMessages.current &&\n      convoMessages.current?.length &&\n      !isLoadingMessages &&\n      !isLoadingPrevMessages\n    ) {\n      setIsLoadingPrevMessages(true);\n      getConvoMessages().then(() => {\n        setIsLoadingPrevMessages(false);\n        scrollToMiddle();\n      });\n    }\n  };\n\n  const startConversation = async (e) => {\n    e.preventDefault();\n\n    if (formData?.message?.text?.length > 0) {\n      setIsSubmitting(true);\n      try {\n        let response = await fetch(\n          `${baseURL}api/conversations/incoming-messages/widget/${liveChatCredentials?.to}`,\n          {\n            method: \"POST\",\n            body: JSON.stringify({\n              email: formData?.email,\n              name: formData?.name,\n              message: formData?.message,\n            }),\n            headers: {\n              \"Content-type\": \"application/json; charset=UTF-8\",\n            },\n          }\n        );\n        const res = await response.json();\n\n        const success = res?.success;\n        if (success === true) {\n          setFormData({\n            ...formData,\n            message: \"\",\n          });\n          conversationIdRef.current = res?.data?.conversation_id;\n          localStorage.setItem(\"conversationId\", res?.data?.conversation_id);\n          setConvoData(res?.data);\n          setIsSubmitting(false);\n          setIsSignUpFormOpen(false);\n        }\n      } catch (err) {\n        setIsSubmitting(false);\n        const errorMessage = getRequestError(err);\n        setErrorMsg(errorMessage);\n      }\n    }\n  };\n\n  const openFileUploader = () => {\n    document.getElementById(\"selectImage\").click();\n  };\n\n  const handleUploadFile = async (e) => {\n    e.preventDefault();\n    const { files } = e?.target;\n    const fileToUpload = files[0];\n\n    if (fileToUpload) {\n      setIsUploading(true);\n\n      var fileData = new FormData();\n      fileData.append(\"media\", fileToUpload);\n\n      try {\n        let response = await fetch(`${baseURL}api/utils/upload`, {\n          method: \"POST\",\n          body: fileData,\n        });\n        const res = await response.json();\n\n        if (res?.success === true) {\n          setFormData({\n            ...formData,\n            message: {\n              ...formData?.message,\n              attachment: {\n                url: res?.data,\n                type: \"IMAGE\",\n              },\n            },\n          });\n          setIsUploading(false);\n        }\n      } catch (err) {\n        const errorMessage = getRequestError(err);\n        setErrorMsg(errorMessage);\n        setIsUploading(false);\n      }\n    }\n  };\n\n  const replyConversation = async () => {\n    if (formData?.message?.text?.length > 0) {\n      convoMessages.current = [\n        ...convoMessages.current,\n        {\n          id: \"new\",\n          imageUrl: formData?.message?.attachment?.url,\n          content: formData?.message?.text,\n          updatedAt: new Date(),\n        },\n      ];\n      setIsSubmitting(true);\n      triggerScrollToBottom(true);\n\n      try {\n        let response = await fetch(\n          `${baseURL}api/conversations/incoming-messages/widget/${liveChatCredentials?.to}`,\n          {\n            method: \"POST\",\n            body: JSON.stringify({\n              email: formData?.email,\n              name: formData?.name,\n              message: formData?.message,\n            }),\n            headers: {\n              \"Content-type\": \"application/json; charset=UTF-8\",\n            },\n          }\n        );\n        const res = await response.json();\n\n        const success = res?.success;\n        if (success === true) {\n          setFormData({\n            ...formData,\n            message: { text: \"\" },\n          });\n          setIsSubmitting(false);\n        }\n      } catch (err) {\n        const filteredMessage = convoMessages.current?.filter(\n          (x) => x?.id !== \"new\"\n        );\n        convoMessages.current = filteredMessage;\n        setIsSubmitting(null);\n        const errorMessage = getRequestError(err);\n        setErrorMsg(errorMessage);\n      }\n\n      triggerScrollToBottom(false);\n    }\n  };\n\n  return (\n    <>\n      {showWidget ? (\n        <>\n          {isWidgetOpen && (\n            <div className={`widget_container ${isWidgetOpen ? \"\" : \"none\"}`}>\n              {isLiveChatOpen ? (\n                <>\n                  <div\n                    className=\"chat_header\"\n                    style={{\n                      backgroundColor: color,\n                      color: determineColorFromBg(),\n                    }}\n                  >\n                    <div\n                      className=\"chevron\"\n                      onClick={() => setIsLiveChatOpen(false)}\n                    >\n                      <img\n                        src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/chevron.svg\"\n                        alt=\"\"\n                      />\n                    </div>\n                    <img className=\"logo\" src={logo} alt=\"\" />\n                    <p>{convoData?.agent || liveChatCredentials?.identifier}</p>\n                  </div>\n                  {errorMsg && <p className=\"error_message\">{errorMsg}</p>}\n                  <div className=\"chat_container\">\n                    {isSignUpFormOpen ? (\n                      <form className=\"chat_signup_form\">\n                        <div className=\"form_group\">\n                          <input\n                            name=\"name\"\n                            placeholder=\"Your name\"\n                            onChange={handleChange}\n                            className=\"input\"\n                          />\n                        </div>\n                        <div className=\"form_group\">\n                          <input\n                            name=\"email\"\n                            type=\"email\"\n                            placeholder=\"Your email\"\n                            onChange={handleChange}\n                            className=\"input\"\n                          />\n                        </div>\n                        <div className=\"form_group\">\n                          <textarea\n                            name=\"text\"\n                            placeholder=\"Type message here...\"\n                            onChange={handleMessageChange}\n                            className=\"input\"\n                          />\n                        </div>\n                        <button\n                          onClick={startConversation}\n                          disabled={\n                            !formData?.name ||\n                            !formData?.email ||\n                            !formData?.message?.text ||\n                            isSubmitting\n                          }\n                        >\n                          Start Conversation\n                        </button>\n                      </form>\n                    ) : (\n                      <>\n                        <div className=\"chat_messages\" ref={chatContentRef}>\n                          {isLoadingPrevMessages ? (\n                            <div className=\"load_previous\">\n                              Loading previous messages...\n                            </div>\n                          ) : (\n                            !isLastPageOfMessages.current && (\n                              <div className=\"load_previous\">\n                                Scroll up to load previous messages\n                              </div>\n                            )\n                          )}\n                          {convoMessages.current?.map((msg, i) => (\n                            <div\n                              key={i}\n                              className={`message ${\n                                msg?.sender?.authUser === true ? \"agent\" : \"\"\n                              }`}\n                            >\n                              {msg?.sender?.authUser === true && (\n                                <img className=\"agent_img\" src={logo} alt=\"\" />\n                              )}\n                              <div className=\"content\">\n                                {msg?.imageUrl && (\n                                  <img src={msg?.imageUrl} alt=\"\" />\n                                )}\n                                <h6>{msg?.content}</h6>\n                                <p>{formatTime(msg?.updatedAt)}</p>\n                              </div>\n                            </div>\n                          ))}\n                          {isUploading === true && (\n                            <p className=\"send_status\">Uploading...</p>\n                          )}\n                          {isSubmitting === true && (\n                            <p className=\"send_status\">Sending...</p>\n                          )}\n                          {isSubmitting === false && (\n                            <p className=\"send_status\">Sent</p>\n                          )}\n                          {isLoadingMessages === true && (\n                            <p className=\"loading\">Loading...</p>\n                          )}\n                          {scrolltoBottom && <ScrollToBottom />}\n                        </div>\n                        <div className=\"chat_input_container\">\n                          <textarea\n                            name=\"text\"\n                            type=\"text\"\n                            className=\"input\"\n                            rows=\"2\"\n                            placeholder=\"Type a message here...\"\n                            value={formData?.message?.text}\n                            onChange={handleMessageChange}\n                          />\n                          {formData?.message?.attachment && (\n                            <div className=\"file_container\">\n                              <img\n                                src={formData?.message?.attachment?.url}\n                                className=\"file\"\n                                alt=\"\"\n                              />\n                              <img\n                                src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/close.svg\"\n                                alt=\"\"\n                                className=\"close\"\n                                onClick={() =>\n                                  setFormData({\n                                    ...formData,\n                                    message: {\n                                      ...formData?.message,\n                                      attachment: null,\n                                    },\n                                  })\n                                }\n                              />\n                            </div>\n                          )}\n\n                          <div className=\"input_actions\">\n                            {/* <div className=\"action\">\n                          <img\n                            src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/smile.svg\"\n                            alt=\"\"\n                          />\n                        </div> */}\n                            <div className=\"action\" onClick={openFileUploader}>\n                              <img\n                                src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/attachment.svg\"\n                                alt=\"\"\n                              />\n                              <input\n                                id=\"selectImage\"\n                                hidden\n                                type=\"file\"\n                                onChange={handleUploadFile}\n                              />\n                            </div>\n                            <div className=\"action\" onClick={replyConversation}>\n                              <img\n                                src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/send.svg\"\n                                alt=\"\"\n                              />\n                            </div>\n                          </div>\n                        </div>\n                      </>\n                    )}\n                    <div className=\"footer\">\n                      <img\n                        src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/oneroute.svg\"\n                        alt=\"\"\n                      />{\" \"}\n                      <span>\n                        Powered by{\" \"}\n                        <a\n                          href=\"https://oneroute.io\"\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                        >\n                          OneRoute\n                        </a>\n                      </span>\n                    </div>\n                  </div>\n                </>\n              ) : (\n                <>\n                  <div\n                    className=\"top_section\"\n                    style={{\n                      backgroundColor: color,\n                      color: determineColorFromBg(),\n                    }}\n                  >\n                    <div\n                      className=\"close\"\n                      onClick={() => setIsWidgetOpen(!isWidgetOpen)}\n                    >\n                      <img\n                        src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/chevron.svg\"\n                        alt=\"\"\n                      />\n                    </div>\n                    <img className=\"logo\" src={logo} alt=\"\" />\n                    <h3>{headText}</h3>\n                    <h4>{subText}</h4>\n                  </div>\n                  <div className=\"bottom_section\">\n                    <div className=\"channels\">\n                      {channels?.map(({ name, to }, i) => (\n                        <React.Fragment key={i}>\n                          {name?.toLowerCase() === \"livechat\" ? (\n                            <div\n                              className=\"item\"\n                              onClick={() => setIsLiveChatOpen(true)}\n                            >\n                              <img src={getChannelIcon(name)} alt=\"\" />\n                              <span>{name}</span>\n                            </div>\n                          ) : (\n                            <a\n                              href={to}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"item\"\n                            >\n                              <img src={getChannelIcon(name)} alt=\"\" />\n                              <span>{name}</span>\n                            </a>\n                          )}\n                        </React.Fragment>\n                      ))}\n                    </div>\n\n                    <div className=\"footer\">\n                      <img\n                        src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/oneroute.svg\"\n                        alt=\"\"\n                      />{\" \"}\n                      <span>\n                        Powered by{\" \"}\n                        <a\n                          href=\"https://oneroute.io\"\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                        >\n                          OneRoute\n                        </a>\n                      </span>\n                    </div>\n                  </div>\n                </>\n              )}\n            </div>\n          )}\n          {!isWidgetOpen && (\n            <div className=\"trigger_container\">\n              {isWidgetTooltipOpen && toolTip && (\n                <div className={`tooltip ${isWidgetOpen ? \"none\" : \"\"}`}>\n                  {toolTip}\n                  <span></span>\n                  <img\n                    src=\"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/close.svg\"\n                    alt=\"\"\n                    onClick={() => setIsWidgetTooltipOpen(false)}\n                  />\n                </div>\n              )}\n              <div\n                className=\"trigger_btn\"\n                style={{ backgroundColor: color || \"#000\" }}\n                onClick={() => setIsWidgetOpen(!isWidgetOpen)}\n              >\n                <img\n                  src={\n                    logo ||\n                    \"https://s3.eu-west-3.amazonaws.com/oneroute.asb.ng/oneroute-w.svg\"\n                  }\n                  className={!isWidgetOpen ? \"closed\" : \"\"}\n                  alt=\"\"\n                />\n              </div>\n            </div>\n          )}\n        </>\n      ) : (\n        <></>\n      )}\n    </>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nconst root = document.querySelector(\".oneroute_widget\");\n\nReactDOM.render(<App {...root.dataset} />, root);\n"],"sourceRoot":""}